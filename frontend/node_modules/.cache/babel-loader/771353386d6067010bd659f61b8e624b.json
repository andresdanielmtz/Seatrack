{"ast":null,"code":"import _classCallCheck from \"/Users/kapigoku/Documents/Cosas/Programacio\\u0301n/Phyton/Seatrack/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/kapigoku/Documents/Cosas/Programacio\\u0301n/Phyton/Seatrack/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/kapigoku/Documents/Cosas/Programacio\\u0301n/Phyton/Seatrack/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _get from \"/Users/kapigoku/Documents/Cosas/Programacio\\u0301n/Phyton/Seatrack/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/get\";\nimport _getPrototypeOf from \"/Users/kapigoku/Documents/Cosas/Programacio\\u0301n/Phyton/Seatrack/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/kapigoku/Documents/Cosas/Programacio\\u0301n/Phyton/Seatrack/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\n/**\n * @module ol/renderer/Composite\n */\nimport MapRenderer from './Map.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport RenderEvent from '../render/Event.js';\nimport RenderEventType from '../render/EventType.js';\nimport { CLASS_UNSELECTABLE } from '../css.js';\nimport { checkedFonts } from '../render/canvas.js';\nimport { inView } from '../layer/Layer.js';\nimport { listen, unlistenByKey } from '../events.js';\nimport { replaceChildren } from '../dom.js';\n\n/**\n * @classdesc\n * Canvas map renderer.\n * @api\n */\nvar CompositeMapRenderer = /*#__PURE__*/function (_MapRenderer) {\n  _inherits(CompositeMapRenderer, _MapRenderer);\n  /**\n   * @param {import(\"../Map.js\").default} map Map.\n   */\n  function CompositeMapRenderer(map) {\n    var _this;\n    _classCallCheck(this, CompositeMapRenderer);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CompositeMapRenderer).call(this, map));\n\n    /**\n     * @type {import(\"../events.js\").EventsKey}\n     */\n    _this.fontChangeListenerKey_ = listen(checkedFonts, ObjectEventType.PROPERTYCHANGE, map.redrawText.bind(map));\n\n    /**\n     * @private\n     * @type {HTMLDivElement}\n     */\n    _this.element_ = document.createElement('div');\n    var style = _this.element_.style;\n    style.position = 'absolute';\n    style.width = '100%';\n    style.height = '100%';\n    style.zIndex = '0';\n    _this.element_.className = CLASS_UNSELECTABLE + ' ol-layers';\n    var container = map.getViewport();\n    container.insertBefore(_this.element_, container.firstChild || null);\n\n    /**\n     * @private\n     * @type {Array<HTMLElement>}\n     */\n    _this.children_ = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    _this.renderedVisible_ = true;\n    return _this;\n  }\n\n  /**\n   * @param {import(\"../render/EventType.js\").default} type Event type.\n   * @param {import(\"../Map.js\").FrameState} frameState Frame state.\n   */\n  _createClass(CompositeMapRenderer, [{\n    key: \"dispatchRenderEvent\",\n    value: function dispatchRenderEvent(type, frameState) {\n      var map = this.getMap();\n      if (map.hasListener(type)) {\n        var event = new RenderEvent(type, undefined, frameState);\n        map.dispatchEvent(event);\n      }\n    }\n  }, {\n    key: \"disposeInternal\",\n    value: function disposeInternal() {\n      unlistenByKey(this.fontChangeListenerKey_);\n      this.element_.parentNode.removeChild(this.element_);\n      _get(_getPrototypeOf(CompositeMapRenderer.prototype), \"disposeInternal\", this).call(this);\n    }\n    /**\n     * Render.\n     * @param {?import(\"../Map.js\").FrameState} frameState Frame state.\n     */\n  }, {\n    key: \"renderFrame\",\n    value: function renderFrame(frameState) {\n      if (!frameState) {\n        if (this.renderedVisible_) {\n          this.element_.style.display = 'none';\n          this.renderedVisible_ = false;\n        }\n        return;\n      }\n      this.calculateMatrices2D(frameState);\n      this.dispatchRenderEvent(RenderEventType.PRECOMPOSE, frameState);\n      var layerStatesArray = frameState.layerStatesArray.sort(function (a, b) {\n        return a.zIndex - b.zIndex;\n      });\n      var viewState = frameState.viewState;\n      this.children_.length = 0;\n      /**\n       * @type {Array<import(\"../layer/BaseVector.js\").default>}\n       */\n      var declutterLayers = [];\n      var previousElement = null;\n      for (var i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n        var layerState = layerStatesArray[i];\n        frameState.layerIndex = i;\n        var layer = layerState.layer;\n        var sourceState = layer.getSourceState();\n        if (!inView(layerState, viewState) || sourceState != 'ready' && sourceState != 'undefined') {\n          layer.unrender();\n          continue;\n        }\n        var element = layer.render(frameState, previousElement);\n        if (!element) {\n          continue;\n        }\n        if (element !== previousElement) {\n          this.children_.push(element);\n          previousElement = element;\n        }\n        if ('getDeclutter' in layer) {\n          declutterLayers.push( /** @type {import(\"../layer/BaseVector.js\").default} */layer);\n        }\n      }\n      for (var _i = declutterLayers.length - 1; _i >= 0; --_i) {\n        declutterLayers[_i].renderDeclutter(frameState);\n      }\n      replaceChildren(this.element_, this.children_);\n      this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE, frameState);\n      if (!this.renderedVisible_) {\n        this.element_.style.display = '';\n        this.renderedVisible_ = true;\n      }\n      this.scheduleExpireIconCache(frameState);\n    }\n  }]);\n  return CompositeMapRenderer;\n}(MapRenderer);\nexport default CompositeMapRenderer;","map":null,"metadata":{},"sourceType":"module"}